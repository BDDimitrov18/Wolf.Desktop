<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Wolf.Desktop.ViewModels"
             xmlns:conv="using:Wolf.Desktop.Converters"
             x:Class="Wolf.Desktop.Views.OrderClientLinkView"
             x:CompileBindings="False"
             Background="{StaticResource BrushSurface}">

    <UserControl.Resources>
        <conv:ClientNameConverter x:Key="ClientNameConverter"/>
    </UserControl.Resources>

    <ScrollViewer>
        <StackPanel Spacing="0" MaxWidth="720" Margin="32">

            <TextBlock Text="{Binding FormTitle}"
                       FontSize="20" FontWeight="Bold"
                       Margin="0,0,0,28"/>

            <Border IsVisible="{Binding ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                    Background="#fceaea"
                    CornerRadius="6"
                    Padding="14,10"
                    Margin="0,0,0,16">
                <TextBlock Text="{Binding ErrorMessage}"
                           Foreground="#b83232" FontSize="12"/>
            </Border>

            <!-- ===== LINK EXISTING CLIENT ===== -->
            <Border Background="{StaticResource BrushSurfaceAlt}"
                    CornerRadius="8"
                    Padding="24"
                    Margin="0,0,0,16">
                <StackPanel Spacing="16">
                    <TextBlock Text="СВЪРЗВАНЕ НА СЪЩЕСТВУВАЩ КЛИЕНТ"
                               FontSize="10" FontWeight="Bold"
                               Foreground="{StaticResource BrushTextMuted}"
                               LetterSpacing="1"/>

                    <StackPanel Spacing="6">
                        <TextBlock Text="Търсене на клиент" FontSize="12" FontWeight="Medium"/>
                        <AutoCompleteBox x:Name="ClientSearchBox"
                                         ItemsSource="{Binding AvailableClients}"
                                         SelectedItem="{Binding SelectedExistingClient}"
                                         ValueMemberBinding="{Binding ., Converter={StaticResource ClientNameConverter}}"
                                         FilterMode="Custom"
                                         MinimumPrefixLength="0"
                                         Watermark="Въведете име на клиент..."/>
                    </StackPanel>

                    <Button Classes="primary"
                            Command="{Binding LinkExistingCommand}"
                            IsEnabled="{Binding IsBusy, Converter={x:Static BoolConverters.Not}}">
                        Свържи
                    </Button>
                </StackPanel>
            </Border>

            <!-- ===== SEPARATOR ===== -->
            <Grid ColumnDefinitions="*,Auto,*" Margin="0,8,0,24">
                <Rectangle Grid.Column="0" Height="1" Fill="{StaticResource BrushBorder}" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="1" Text="  или създай нов клиент  "
                           FontSize="11" Foreground="{StaticResource BrushTextMuted}"/>
                <Rectangle Grid.Column="2" Height="1" Fill="{StaticResource BrushBorder}" VerticalAlignment="Center"/>
            </Grid>

            <!-- ===== CREATE NEW CLIENT ===== -->
            <Border Background="{StaticResource BrushSurfaceAlt}"
                    CornerRadius="8"
                    Padding="24"
                    Margin="0,0,0,16">
                <StackPanel Spacing="16">
                    <TextBlock Text="ЛИЧНИ ДАННИ"
                               FontSize="10" FontWeight="Bold"
                               Foreground="{StaticResource BrushTextMuted}"
                               LetterSpacing="1"/>

                    <Grid ColumnDefinitions="*,16,*,16,*">
                        <StackPanel Grid.Column="0" Spacing="6">
                            <TextBlock Text="Име" FontSize="12" FontWeight="Medium"/>
                            <TextBox Text="{Binding Firstname}" Watermark="Име"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Spacing="6">
                            <TextBlock Text="Презиме" FontSize="12" FontWeight="Medium"/>
                            <TextBox Text="{Binding Middlename}" Watermark="Незадължително"/>
                        </StackPanel>
                        <StackPanel Grid.Column="4" Spacing="6">
                            <TextBlock Text="Фамилия" FontSize="12" FontWeight="Medium"/>
                            <TextBox Text="{Binding Lastname}" Watermark="Фамилия"/>
                        </StackPanel>
                    </Grid>

                    <StackPanel Spacing="6">
                        <TextBlock Text="Правен тип" FontSize="12" FontWeight="Medium"/>
                        <ComboBox ItemsSource="{x:Static vm:EditClientViewModel.LegalTypeOptions}"
                                  SelectedItem="{Binding Clientlegaltype}"
                                  HorizontalAlignment="Stretch"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <Border Background="{StaticResource BrushSurfaceAlt}"
                    CornerRadius="8"
                    Padding="24"
                    Margin="0,0,0,16">
                <StackPanel Spacing="16">
                    <TextBlock Text="ИНФОРМАЦИЯ ЗА КОНТАКТ"
                               FontSize="10" FontWeight="Bold"
                               Foreground="{StaticResource BrushTextMuted}"
                               LetterSpacing="1"/>

                    <Grid ColumnDefinitions="*,16,*">
                        <StackPanel Grid.Column="0" Spacing="6">
                            <TextBlock Text="Телефон" FontSize="12" FontWeight="Medium"/>
                            <TextBox Text="{Binding Phone}" Watermark="+359 ..."/>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Spacing="6">
                            <TextBlock Text="Имейл" FontSize="12" FontWeight="Medium"/>
                            <TextBox Text="{Binding Email}" Watermark="email@example.com"/>
                        </StackPanel>
                    </Grid>

                    <StackPanel Spacing="6">
                        <TextBlock Text="Адрес" FontSize="12" FontWeight="Medium"/>
                        <TextBox Text="{Binding Address}"
                                 TextWrapping="Wrap"
                                 Height="60"
                                 Watermark="Пълен адрес..."/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <Button Classes="primary"
                    Command="{Binding CreateAndLinkCommand}"
                    IsEnabled="{Binding IsBusy, Converter={x:Static BoolConverters.Not}}">
                Създай и свържи
            </Button>
        </StackPanel>
    </ScrollViewer>
</UserControl>
